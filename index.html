<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cybersecurity Capstone Project: Weekly Progress Report</title>
  <style>
    /* Modern Professional Design System */
    :root {
      --primary-color: #1a73e8;
      --primary-dark: #0d47a1;
      --secondary-color: #34a853;
      --danger-color: #ea4335;
      --text-color: #202124;
      --text-secondary: #5f6368;
      --border-color: #dadce0;
      --background-primary: #ffffff;
      --background-secondary: #f8f9fa;
      --box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      --border-radius: 8px;
      --transition: all 0.3s cubic-bezier(.25,.8,.25,1);
    }
    
    /* Base Styles */
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Roboto', 'Segoe UI', Arial, sans-serif;
      background-color: var(--background-secondary);
      color: var(--text-color);
      margin: 0 auto;
      max-width: 1200px;
      padding: 20px;
      line-height: 1.5;
    }
    
    h1, h2, h3 {
      color: var(--primary-dark);
      margin-top: 0;
    }
    
    h1 {
      font-size: 2.2rem;
      text-align: center;
      margin-bottom: 0.5rem;
    }
    
    h2 {
      font-size: 1.5rem;
      border-bottom: 2px solid var(--primary-color);
      padding-bottom: 8px;
      margin-bottom: 20px;
    }
    
    h3 {
      font-size: 1.2rem;
    }
    
    /* Container styles */
    .container {
      background-color: var(--background-primary);
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 30px;
      margin-bottom: 20px;
    }
    
    /* Header Section */
    .header {
      text-align: center;
      padding: 20px 0;
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 30px;
    }
    
    .header-subtitle {
      color: var(--text-secondary);
      font-size: 1.2rem;
      margin-top: 0;
    }
    
    /* Navigation Bar */
    .navbar {
      background-color: var(--primary-color);
      border-radius: var(--border-radius);
      margin-bottom: 25px;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: var(--box-shadow);
    }
    
    .navbar ul {
      display: flex;
      list-style: none;
      padding: 0;
      margin: 0;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .navbar li {
      margin: 0;
    }
    
    .navbar a {
      color: white;
      text-decoration: none;
      padding: 15px 20px;
      display: block;
      transition: var(--transition);
      border-radius: var(--border-radius);
      font-weight: 500;
    }
    
    .navbar a:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }
    
    /* Form Elements */
    .form-group {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: var(--primary-dark);
    }
    
    input[type="text"],
    input[type="date"],
    textarea,
    select {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      font-size: 16px;
      transition: var(--transition);
    }
    
    input[type="text"]:focus,
    input[type="date"]:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
    }
    
    textarea {
      min-height: 120px;
      resize: vertical;
    }
    
    select {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 16px;
      padding-right: 40px;
    }
    
    /* Grid Layout */
    .row {
      display: flex;
      flex-wrap: wrap;
      margin: 0 -15px;
    }
    
    .col {
      flex: 1;
      padding: 0 15px;
      min-width: 250px;
    }
    
    /* Section styling */
    .section {
      background: var(--background-primary);
      margin: 25px 0;
      padding: 25px;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
    }
    
    /* System Time Display */
    .system-time {
      text-align: right;
      color: var(--text-secondary);
      margin-bottom: 20px;
      font-size: 0.9rem;
    }
    
    /* Button styling */
    .btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    
    .btn:hover {
      background-color: var(--primary-dark);
      box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
    }
    
    .btn-success {
      background-color: var(--secondary-color);
    }
    
    .btn-success:hover {
      background-color: #2d9048;
    }
    
    .btn-danger {
      background-color: var(--danger-color);
    }
    
    .btn-danger:hover {
      background-color: #c62828;
    }
    
    .btn-group {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 30px;
    }
    
    /* Screenshot handling */
    .screenshot-container {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      background-color: var(--background-secondary);
    }
    
    .screenshot-preview {
      max-width: 100%;
      max-height: 300px;
      margin: 15px 0;
      display: block;
      border-radius: 4px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .screenshot-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }
    
    /* Checklist Table */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      border-radius: var(--border-radius);
      overflow: hidden;
    }
    
    th, td {
      padding: 12px 15px;
      text-align: left;
      border: 1px solid var(--border-color);
    }
    
    th {
      background-color: var(--primary-color);
      color: white;
      font-weight: 500;
    }
    
    tr:nth-child(even) {
      background-color: var(--background-secondary);
    }
    
    td input[type="text"] {
      margin: 0;
      padding: 8px;
    }
    
    /* Print styles */
    @media print {
      body {
        background-color: white;
        padding: 0;
        font-size: 12pt;
      }
      
      .section, .container {
        box-shadow: none;
        border: 1px solid #eee;
        margin: 15px 0;
        page-break-inside: avoid;
      }
      
      .navbar, .btn-group, .add-screenshot-btn, .remove-screenshot-btn {
        display: none;
      }
      
      h1 {
        font-size: 18pt;
      }
      
      h2 {
        font-size: 14pt;
      }
      
      .screenshot-preview {
        max-height: none;
      }
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .col {
        flex: 100%;
      }
      
      .navbar ul {
        flex-direction: column;
      }
      
      .navbar a {
        border-radius: 0;
      }
    }
    
    /* Additional styling for header info layout in report */
    .header-info {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }
    .header-info div {
      flex: 1;
      min-width: 250px;
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ICT 946: Cybersecurity Capstone Project</h1>
      <p class="header-subtitle">Assessment 1: Weekly Progress Report</p>
    </div>
    
    <!-- System Time Display -->
    <div class="system-time">
      Current Time: <span id="systemTime"></span>
    </div>

    <!-- Navigation Menu -->
    <nav class="navbar">
      <ul>
        <li><a href="#student-info">Student Info</a></li>
        <li><a href="#todo">Todo</a></li>
        <li><a href="#weekly-progress">Weekly Progress</a></li>
        <li><a href="#functions-implemented">Implementation</a></li>
        <li><a href="#challenges">Challenges</a></li>
        <li><a href="#feedback">Feedback</a></li>
        <li><a href="#plan">Plan</a></li>
        <li><a href="#notes">Notes</a></li>
        <li><a href="#checklist">Checklist</a></li>
        <li><a href="#signature">Signature</a></li>
      </ul>
    </nav>

    <!-- Student Information Section -->
    <div id="student-info" class="section">
      <h2>Student Information</h2>
      <div class="row">
        <div class="col">
          <div class="form-group">
            <label for="studentName">Student Name</label>
            <input type="text" id="studentName" placeholder="Enter your full name">
          </div>
        </div>
        <div class="col">
          <div class="form-group">
            <label for="studentID">Student ID</label>
            <input type="text" id="studentID" placeholder="Enter your student ID">
          </div>
        </div>
      </div>
      
      <div class="form-group">
        <label for="projectTitle">Project Title</label>
        <input type="text" id="projectTitle" placeholder="Enter your project title">
      </div>
      
      <div class="form-group">
        <label for="supervisorName">Supervisor Name</label>
        <input type="text" id="supervisorName" placeholder="Enter your supervisor's name">
      </div>
      
      <div class="row">
        <div class="col">
          <div class="form-group">
            <label for="weekNumber">Week Number (out of 8)</label>
            <input type="text" id="weekNumber" placeholder="Enter week number">
          </div>
        </div>
        <div class="col">
          <div class="form-group">
            <label for="submissionDate">Date of Submission</label>
            <input type="date" id="submissionDate">
          </div>
        </div>
      </div>
    </div>

    <!-- Todo Section -->
    <div id="todo" class="section">
      <h2>Todo List</h2>
      <div class="form-group">
        <label for="todoList">Tasks to be completed</label>
        <textarea id="todoList" placeholder="List the tasks you need to complete..."></textarea>
      </div>
    </div>

    <!-- Weekly Progress -->
    <div id="weekly-progress" class="section">
      <h2>1. Summary of Weekly Progress</h2>
      <div class="form-group">
        <label for="weeklyProgress">Detail your accomplishments this week</label>
        <textarea id="weeklyProgress" class="no-paste" placeholder="Briefly describe the progress made this week..."></textarea>
      </div>
    </div>

    <!-- Functions/Procedures Implemented -->
    <div id="functions-implemented" class="section">
      <h2>2. Implementation or Outcome</h2>
      <div class="form-group">
        <label for="functionsImplemented">Describe functions/modules and key code segments</label>
        <textarea id="functionsImplemented" class="no-paste" placeholder="List the implemented functions or modules with explanations..."></textarea>
      </div>
      
      <h3>Implementation Screenshots</h3>
      <div id="screenshotContainer">
        <div class="screenshot-container" id="screenshot-entry-1">
          <div class="form-group">
            <label>Upload Screenshot</label>
            <input type="file" class="screenshot-input" accept="image/*">
          </div>
          <div class="form-group">
            <label>Caption</label>
            <input type="text" class="screenshot-caption" placeholder="Describe this screenshot">
          </div>
          <img class="screenshot-preview" src="" alt="Preview Screenshot">
          <div class="screenshot-actions">
            <button type="button" class="btn btn-danger" onclick="removeScreenshot(1)">Remove</button>
          </div>
        </div>
      </div>
      <button type="button" class="btn btn-success" onclick="addScreenshot()">+ Add Another Screenshot</button>
    </div>

    <!-- Challenges Faced -->
    <div id="challenges" class="section">
      <h2>3. Challenges Faced & Problem-Solving Approach</h2>
      <div class="form-group">
        <label for="challengesFaced">Describe technical challenges and solutions</label>
        <textarea id="challengesFaced" class="no-paste" placeholder="Describe any technical challenges and how you addressed them..."></textarea>
      </div>
    </div>

    <!-- Feedback Section -->
    <div id="feedback" class="section">
      <h2>4. Feedback from Supervisor & How It Was Addressed</h2>
      <div class="form-group">
        <label for="supervisorFeedback">Detail feedback and implementation</label>
        <textarea id="supervisorFeedback" placeholder="Summarize feedback received and how it was addressed..."></textarea>
      </div>
    </div>

    <!-- Plan Section -->
    <div id="plan" class="section">
      <h2>5. Plan for Next Week</h2>
      <div class="form-group">
        <label for="planNextWeek">Outline future tasks and deliverables</label>
        <textarea id="planNextWeek" placeholder="Outline your plan and expected deliverables for next week..."></textarea>
      </div>
    </div>

    <!-- Additional Notes -->
    <div id="notes" class="section">
      <h2>6. Additional Notes or Requests for Supervisor</h2>
      <div class="form-group">
        <label for="additionalNotes">Include any other relevant information</label>
        <textarea id="additionalNotes" placeholder="Any additional notes or requests..."></textarea>
      </div>
    </div>

    <!-- Progress Status Checklist -->
    <div id="checklist" class="section">
      <h2>7. Progress Status Checklist</h2>
      <table>
        <thead>
          <tr>
            <th>Task</th>
            <th>Completed?</th>
            <th>Comments</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Implemented planned functions/modules</td>
            <td>
              <select id="task1">
                <option value="">Select</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
              </select>
            </td>
            <td><input type="text" id="comment1" placeholder="Comments"></td>
          </tr>
          <tr>
            <td>Addressed supervisor feedback</td>
            <td>
              <select id="task2">
                <option value="">Select</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
              </select>
            </td>
            <td><input type="text" id="comment2" placeholder="Comments"></td>
          </tr>
          <tr>
            <td>Tested implemented features</td>
            <td>
              <select id="task3">
                <option value="">Select</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
              </select>
            </td>
            <td><input type="text" id="comment3" placeholder="Comments"></td>
          </tr>
          <tr>
            <td>Updated documentation</td>
            <td>
              <select id="task4">
                <option value="">Select</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
              </select>
            </td>
            <td><input type="text" id="comment4" placeholder="Comments"></td>
          </tr>
          <tr>
            <td>Identified next week's tasks</td>
            <td>
              <select id="task5">
                <option value="">Select</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
              </select>
            </td>
            <td><input type="text" id="comment5" placeholder="Comments"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Student Signature -->
    <div id="signature" class="section">
      <h2>Student Signature</h2>
      <div class="form-group">
        <label for="studentSignature">Type your signature</label>
        <input type="text" id="studentSignature" placeholder="Your signature">
      </div>
    </div>

    <div class="btn-group">
      <button class="btn" onclick="generateReport()">Generate Report</button>
    </div>
  </div>

  <script>
    // Update system time display on the app (update every second)
    function updateSystemTime() {
      const now = new Date();
      document.getElementById('systemTime').textContent = now.toLocaleTimeString();
    }
    setInterval(updateSystemTime, 1000);
    updateSystemTime(); // initial call

    // Counter for screenshot IDs
    let screenshotCounter = 1;

    // Function to add a new screenshot entry
    function addScreenshot() {
      screenshotCounter++;
      const container = document.getElementById('screenshotContainer');
      const newScreenshotDiv = document.createElement('div');
      newScreenshotDiv.className = 'screenshot-container';
      newScreenshotDiv.id = 'screenshot-entry-' + screenshotCounter;
      
      newScreenshotDiv.innerHTML = `
        <div class="form-group">
          <label>Upload Screenshot</label>
          <input type="file" class="screenshot-input" accept="image/*">
        </div>
        <div class="form-group">
          <label>Caption</label>
          <input type="text" class="screenshot-caption" placeholder="Describe this screenshot">
        </div>
        <img class="screenshot-preview" src="" alt="Preview Screenshot">
        <div class="screenshot-actions">
          <button type="button" class="btn btn-danger" onclick="removeScreenshot(${screenshotCounter})">Remove</button>
        </div>
      `;
      
      container.appendChild(newScreenshotDiv);
      
      // Add change listener for the new file input
      const newInput = newScreenshotDiv.querySelector('.screenshot-input');
      newInput.addEventListener('change', function() {
        handleFileSelect(this);
      });
    }

    // Function to remove a screenshot entry
    function removeScreenshot(id) {
      const screenshotDiv = document.getElementById('screenshot-entry-' + id);
      if (screenshotDiv) {
        screenshotDiv.remove();
      }
    }

    // Function to handle file selection and preview
    function handleFileSelect(input) {
      const preview = input.closest('.screenshot-container').querySelector('.screenshot-preview');
      const file = input.files[0];
      
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          preview.src = e.target.result;
        };
        reader.readAsDataURL(file);
      } else {
        preview.src = "";
      }
    }

    // Disable paste for designated fields (those with class "no-paste")
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll('.no-paste').forEach(field => {
        field.addEventListener('paste', e => {
          e.preventDefault();
        });
      });
      
      // Set up file input change listeners to show image previews
      document.querySelectorAll('.screenshot-input').forEach(input => {
        input.addEventListener('change', function() {
          handleFileSelect(this);
        });
      });
    });

    // Generate the report; using async to wait for file uploads
    async function generateReport() {
      // Gather form data
      const data = {
        studentName: document.getElementById('studentName').value,
        studentID: document.getElementById('studentID').value,
        projectTitle: document.getElementById('projectTitle').value,
        supervisorName: document.getElementById('supervisorName').value,
        weekNumber: document.getElementById('weekNumber').value,
        submissionDate: document.getElementById('submissionDate').value,
        todoList: document.getElementById('todoList').value,
        weeklyProgress: document.getElementById('weeklyProgress').value,
        functionsImplemented: document.getElementById('functionsImplemented').value,
        challengesFaced: document.getElementById('challengesFaced').value,
        supervisorFeedback: document.getElementById('supervisorFeedback').value,
        planNextWeek: document.getElementById('planNextWeek').value,
        additionalNotes: document.getElementById('additionalNotes').value,
        checklist: [
          {
            task: "Implemented planned functions/modules",
            completed: document.getElementById('task1').value,
            comments: document.getElementById('comment1').value,
          },
          {
            task: "Addressed supervisor feedback",
            completed: document.getElementById('task2').value,
            comments: document.getElementById('comment2').value,
          },
          {
            task: "Tested implemented features",
            completed: document.getElementById('task3').value,
            comments: document.getElementById('comment3').value,
          },
          {
            task: "Updated documentation",
            completed: document.getElementById('task4').value,
            comments: document.getElementById('comment4').value,
          },
          {
            task: "Identified next week's tasks",
            completed: document.getElementById('task5').value,
            comments: document.getElementById('comment5').value,
          },
        ],
        studentSignature: document.getElementById('studentSignature').value,
        // Capture system information (computer/browser details)
        systemInfo: navigator.userAgent + " | " + window.screen.width + "x" + window.screen.height + " | Platform: " + navigator.platform,
        submissionTime: new Date().toLocaleString(),
        screenshots: []
      };

      // Collect all screenshots
      const screenshotContainers = document.querySelectorAll('.screenshot-container');
      for (let container of screenshotContainers) {
        const fileInput = container.querySelector('.screenshot-input');
        const caption = container.querySelector('.screenshot-caption').value;
        
        if (fileInput.files.length > 0) {
          try {
            const dataUrl = await new Promise((resolve, reject) => {
              const reader = new FileReader();
              reader.onload = e => resolve(e.target.result);
              reader.onerror = reject;
              reader.readAsDataURL(fileInput.files[0]);
            });
            
            data.screenshots.push({
              image: dataUrl,
              caption: caption || `Screenshot ${data.screenshots.length + 1}`
            });
          } catch (error) {
            console.error("Error reading file:", error);
          }
        }
      }

      // Build the report HTML
      // Added a static "Project Overview" section to guarantee at least 20 words in the report.
      let reportHTML = `
        <!DOCTYPE html>
        <html>
        <head>
          <title>Weekly Progress Report</title>
          <style>
            :root {
              --primary-color: #1a73e8;
              --text-color: #202124;
              --border-color: #dadce0;
            }
            body { 
              font-family: 'Roboto', 'Segoe UI', Arial, sans-serif; 
              padding: 30px; 
              max-width: 1100px;
              margin: 0 auto;
              color: var(--text-color);
              line-height: 1.6;
            }
            h1, h2, h3 { 
              color: var(--primary-color); 
              margin-top: 1.5em;
              margin-bottom: 0.5em;
            }
            h1 { 
              text-align: center; 
              font-size: 24pt;
              margin-top: 0;
              border-bottom: 2px solid var(--primary-color);
              padding-bottom: 10px;
            }
            h2 { 
              font-size: 16pt; 
              border-bottom: 1px solid var(--border-color);
              padding-bottom: 5px;
            }
            .section { 
              margin-bottom: 25px; 
              page-break-inside: avoid;
            }
            table { 
              width: 100%; 
              border-collapse: collapse; 
              margin: 15px 0;
              page-break-inside: avoid;
            }
            th, td { 
              border: 1px solid var(--border-color); 
              padding: 10px; 
              text-align: left; 
            }
            th { 
              background-color: #f1f3f4; 
            }
            .screenshot { 
              max-width: 100%; 
              height: auto; 
              margin: 15px 0; 
              border: 1px solid #eee; 
              page-break-inside: avoid; 
            }
            .info { 
              font-size: 11pt; 
              color: #5f6368; 
              margin-top: 20px;
              border-top: 1px solid var(--border-color);
              padding-top: 15px;
            }
            .screenshot-block { 
              margin: 25px 0; 
              page-break-inside: avoid; 
            }
            .caption { 
              font-style: italic; 
              color: #5f6368; 
              margin: 5px 0 20px 0; 
            }
            .header-info {
              display: flex;
              flex-wrap: wrap;
              gap: 20px;
              margin-bottom: 20px;
            }
            .header-info div {
              flex: 1;
              min-width: 250px;
            }
            @media print {
              body { 
                font-size: 11pt; 
                padding: 0; 
              }
              .section { 
                page-break-inside: avoid; 
              }
            }
          </style>
          <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
        </head>
        <body>
          <h1>Cybersecurity Capstone Project: Weekly Progress Report</h1>
          
          <div class="section">
            <div class="header-info">
              <div>
                <p><strong>Student Name:</strong> ${data.studentName}</p>
                <p><strong>Project Title:</strong> ${data.projectTitle}</p>
                <p><strong>Week Number:</strong> ${data.weekNumber} of 8</p>
              </div>
              <div>
                <p><strong>Student ID:</strong> ${data.studentID}</p>
                <p><strong>Supervisor:</strong> ${data.supervisorName}</p>
                <p><strong>Submission Date:</strong> ${data.submissionDate}</p>
              </div>
            </div>
          </div>
          
          <!-- Static Project Overview section to guarantee at least 20 words -->
          <div class="section">
            <h2>Project Overview</h2>
            <p>
              This weekly progress report summarizes the work accomplished on the cybersecurity capstone project.
              It details the tasks completed, functions implemented, challenges encountered, feedback received,
              and the plan for the upcoming week. This overview ensures a comprehensive record of the project progress.
            </p>
          </div>
          
          <div class="section">
            <h2>Todo (List of Tasks to be completed)</h2>
            <p>${data.todoList.replace(/\n/g, '<br>')}</p>
          </div>
          
          <div class="section">
            <h2>1. Summary of Weekly Progress</h2>
            <p>${data.weeklyProgress.replace(/\n/g, '<br>')}</p>
          </div>
          
          <div class="section">
            <h2>2. Functions/Procedures Implemented</h2>
            <p>${data.functionsImplemented.replace(/\n/g, '<br>')}</p>
            ${data.screenshots.length > 0 ? '<h3>Implementation Screenshots</h3>' : ''}
            ${data.screenshots.map((screenshot, index) => `
              <div class="screenshot-block">
                <img src="${screenshot.image}" alt="Screenshot ${index + 1}" class="screenshot">
                <p class="caption"><strong>Figure ${index + 1}:</strong> ${screenshot.caption}</p>
              </div>
            `).join('')}
          </div>
          
          <div class="section">
            <h2>3. Challenges Faced & Problem-Solving Approach</h2>
            <p>${data.challengesFaced.replace(/\n/g, '<br>')}</p>
          </div>
          
          <div class="section">
            <h2>4. Feedback from Supervisor & How It Was Addressed</h2>
            <p>${data.supervisorFeedback.replace(/\n/g, '<br>')}</p>
          </div>
          
          <div class="section">
            <h2>5. Plan for Next Week</h2>
            <p>${data.planNextWeek.replace(/\n/g, '<br>')}</p>
          </div>
          
          <div class="section">
            <h2>6. Additional Notes or Requests for Supervisor</h2>
            <p>${data.additionalNotes.replace(/\n/g, '<br>')}</p>
          </div>
          
          <div class="section">
            <h2>7. Progress Status Checklist</h2>
            <table>
              <thead>
                <tr>
                  <th>Task</th>
                  <th>Completed?</th>
                  <th>Comments</th>
                </tr>
              </thead>
              <tbody>
                ${data.checklist.map(item => `
                <tr>
                  <td>${item.task}</td>
                  <td>${item.completed}</td>
                  <td>${item.comments}</td>
                </tr>
                `).join('')}
              </tbody>
            </table>
          </div>
          
          <div class="section">
            <h2>Student Signature</h2>
            <p>${data.studentSignature}</p>
          </div>
          
          <div class="info">
            <p><strong>System Information:</strong> ${data.systemInfo}</p>
            <p><strong>Report Generated On:</strong> ${data.submissionTime}</p>
          </div>
        </body>
        </html>
      `;

      // Open the report in a new window and trigger the print dialog
      const reportWindow = window.open('', '_blank', 'width=800,height=800');
      reportWindow.document.write(reportHTML);
      reportWindow.document.close();
      // Wait a bit to ensure images load before printing
      setTimeout(() => {
        reportWindow.print();
      }, 1000);
    }
  </script>
</body>
</html>
